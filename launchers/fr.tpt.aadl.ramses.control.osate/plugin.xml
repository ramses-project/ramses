<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.ui.propertyPages">
      <page
            name="RAMSES Build"
            class="fr.tpt.aadl.ramses.control.osate.properties.RamsesPropertyPage"
            id="fr.tpt.aadl.ramses.control.osate.properties.RamsesPropertyPage">
         <enabledWhen>
            <instanceof
                  value="org.eclipse.core.resources.IProject">
            </instanceof>
         </enabledWhen>
	     <filter
	           name="nature"
	           value="org.osate.core.aadlnature">
	     </filter>
      </page>
   </extension>
   
   <extension
         point="org.eclipse.ui.actionSets">
      <actionSet
      		label="GenerateCodeAction"
            id="fr.tpt.aadl.ramses.control.osate.generate.pok"
            visible="true">
         <menu
               id="menu.ramses"
               label="RAMSES">
               <separator name="generation"/>
               <groupMarker name="top.grp"/>
         </menu>
         <action
               class="fr.tpt.aadl.ramses.control.osate.GenerateAction"
               id="fr.tpt.aadl.ramses.control.osate.generate.action"
               menubarPath="menu.ramses/top.grp"
               toolbarPath="menu.ramses/generation"
               enablesFor="1"
               label="&amp;Generate Code"
               icon="icons/RAMSES.gif"
               tooltip="Generate code for a given target platform">
            <enablement>
               <or>
                  <and>
                     <objectClass name="org.eclipse.core.resources.IFile"/>
                     <objectState name="extension" value="aaxl2"/>
                  </and>
                  <objectClass name="org.osate.aadl2.instance.SystemInstance"/>
               </or>
            </enablement>
         </action>
      </actionSet>
   </extension>
   
   <extension point="org.osate.ui.analysis">
      <analysis
   		 id="fr.tpt.aadl.ramses.control.osate.generate"
   		 name="RAMSES"
   		 class="fr.tpt.aadl.ramses.control.osate.GenerateAction">
   		 <declarativeModel selectRootObject="true">
   		    <selectedObject objectType="org.osate.aadl2.instance.SystemInstance"/>
   		 </declarativeModel>
   		 <instanceModel selectRootObject="true"/>
   	  </analysis>
   </extension>
   <extension
         point="org.eclipse.ui.newWizards">
      <wizard
            category="org.eclipse.ui.Examples/org.osate.Wizard.category.examples"
            class="fr.tpt.aadl.ramses.osate.wizards.RamsesExamplesWizard"
            icon="icons/RAMSES.gif"
            id="fr.tpt.aadl.ramses.osate.wizard.examples"
            name="RAMSES"
            project="true">
      </wizard>
   </extension>
   
   
   
   
   <extension
		point="org.eclipse.ui.commands">
		<command
			description="Generate the system code with RAMSES"
			id="fr.tpt.aadl.ramses.control.osate.generate.pok"
			name="RAMSES: Generate Code for POK">
		</command>
	</extension>
	
   <extension point="org.eclipse.ui.menus">
	<menuContribution 
		allPopups="false"
		locationURI="popup:org.osate.xtext.aadl2.ui.outline?after=additions">
		<command
		commandId="fr.tpt.aadl.ramses.control.osate.generate.pok"
		tooltip="Do code generation for pok with RAMSES" 
		style="push">
		</command>
	</menuContribution>
   </extension>
   
   <extension
		point="org.eclipse.ui.handlers">
		<handler 
			class="fr.tpt.aadl.ramses.control.osate.PokGenerateActionHandler"
			commandId="fr.tpt.aadl.ramses.control.osate.generate.pok">
		<!--	<activeWhen>
				<reference
					definitionId="org.osate.xtext.aadl2.Aadl2.Editor.opened">
				</reference>
			</activeWhen> -->
		</handler>
	</extension>
	
	   <extension
		point="org.eclipse.ui.commands">
		<command
			description="Generate the system code with RAMSES"
			id="fr.tpt.aadl.ramses.control.osate.generate.osek"
			name="RAMSES: Generate Code for OSEK">
		</command>
	</extension>
	
   <extension point="org.eclipse.ui.menus">
	<menuContribution 
		allPopups="false"
		locationURI="popup:org.osate.xtext.aadl2.ui.outline?after=additions">
		<command
		commandId="fr.tpt.aadl.ramses.control.osate.generate.osek"
		tooltip="Do code generation for osek with RAMSES" 
		style="push">
		</command>
	</menuContribution>
   </extension>
   
   <extension
		point="org.eclipse.ui.handlers">
		<handler 
			class="fr.tpt.aadl.ramses.control.osate.OsekGenerateActionHandler"
			commandId="fr.tpt.aadl.ramses.control.osate.generate.osek">
		<!--	<activeWhen>
				<reference
					definitionId="org.osate.xtext.aadl2.Aadl2.Editor.opened">
				</reference>
			</activeWhen> -->
		</handler>
	</extension>
</plugin>
